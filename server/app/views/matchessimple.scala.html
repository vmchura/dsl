@import views.html.helper._
@import com.mohiva.play.silhouette.impl.providers.SocialProviderRegistry
@this()(implicit assets: AssetsFinder)
@(user: Option[models.User],matches: Seq[MatchDiscord],socialProviders: SocialProviderRegistry)(implicit request: RequestHeader, messages: Messages,menues: Seq[MenuGroup])
@main("Partidas del torneo",user,socialProviders){
    <div id="container-tournament-info">
        <span id="title-tournament-name">@matches.headOption.map(_.tournamentName).getOrElse("Torneo sin partidas")</span>
        <div id="container-tournament-links">
            <a id="title-normas-link" class="tournament-links" href="https://docs.google.com/document/d/1EAx-NbajNBR3Hu14oVUQopbC9-9VSy37qvEtSHnmCm0/edit?usp=sharing">
                <span>Normas del torneo</span>
            </a>
            <br/>
            <a id="title-challonge-link" class="tournament-links" href="https://challonge.com/es/DeathfateChallengerStarLeague3">
                <i class='fab fa-google-drive'></i>
                <span>Challonge del torneo</span>
            </a>
        </div>
    </div>

    <div id="container-matches-finder"></div>

    <table class="table table-striped">
        <thead>
            <tr>
                <th>Round</th>
                <th>Player 1</th>
                <th>Player 2</th>
                <th>Replays</th>
            </tr>
        </thead>
        <tbody>
        @for(m <- matches){
            <tr id="@m.matchPK.challongeMatchID">
                <td>@m.round</td>
                <td>@m.userSmurf1.discordUser.userName
                    @for(smurfDefined <- m.userSmurf1.matchSmurf.distinctBy(_.smurf)){
                        <span class="badge rounded-pill bg-primary">@smurfDefined.smurf </span>
                    }
                </td>
                <td>@m.userSmurf2.discordUser.userName
                @for(smurfDefined <- m.userSmurf2.matchSmurf.distinctBy(_.smurf)){
                    <span class="badge rounded-pill bg-primary">@smurfDefined.smurf </span>
                }
                </td>
                <td>

                    <button type="button" class="btn btn-primary" data-toggle="modal" data-target="@{s"#modal_list_${m.matchPK.challongeMatchID}"}">
                        <span class="material-icons right">info_outline</span>
                    </button>
                </td>

            </tr>



        }
        </tbody>
    </table>


    @for(m <- matches){
        @listreplayssimple(m.convertToMatch(),s"modal_list_${m.matchPK.challongeMatchID}",user.fold(false)(u => WithAdmin.isModeradorID(u.loginInfo.providerKey)))
    }

    <script @{CSPNonce.attr}>   MatchFinder.init("container-matches-finder"); </script>


}
